var cityInput1=$("#cityInput1");var cityInput2=$("#cityInput2");var ciudadSalida=$("#departCity");var ciudadDestino=$("#ciudadDestino");var citySelect1=$("#citySelect1");
var citySelect2=$("#citySelect2");var depCitySelected=$("#depCitySelected");var retCitySelected=$("#retCitySelected");var mdlRegion=1;var modalOpen=false;
var modalCompra=$("#modal-compra");var cityKey1="",cityLabel1="";var cityKey2="",cityLabel2="";var depAirports=[];var depRegions=[];var tabNum=1;var typeOWActive=0;
var flagCalendar=0;var accentMap={"á":"a","é":"e","í":"i","ó":"o","ú":"u"};var normalize=function(d){var b="";for(var c=0;c<d.length;c++){b+=accentMap[d.charAt(c)]||d.charAt(c);
}return b;};var sort_by=function(d,b,e){var c=function(f){return e?e(f[d]):f[d];};return function(h,g){var f=c(h),j=c(g);return(f<j?-1:(f>j?1:0))*[1,-1][+!!b];
};};$(".empty").val("");var lastBtn=$("#main .services fieldset .button").last(),url=$("#main .services .check-in span a").last().attr("href"),a=$("<a>");
a.attr("href",url);a.addClass("button");a.html("Check-in");lastBtn.after(a);lastBtn.remove();function findIndexByKeyValue(e,c,d){for(var b=0;b<e.length;
b++){if(e[b][c]===d){return b;}}return null;}function iChooChooChooseYou(d,f,h,e,b){h.hide();e.html(f.label+'<a href="#" class="close-icon close-icon-'+d+'">×</a>');
e.fadeIn();if(d==1){cityKey1=f.key;if(tabNum==1){$("#sector1_o").val(cityKey1);}if(tabNum==2){$("#origin").val(cityKey1);}var c=findIndexByKeyValue(airports,"key",cityKey1);
depAirports=[];depRegions=[];for(y=0;y<airports[c]["depart"].length;y++){for(z=0;z<airports.length;z++){if(airports[c]["depart"][y]==airports[z].key){depAirports.push(airports[z]);
regionAux=findIndexByKeyValue(depRegions,"regionKey",parseInt(airports[z].region));if(regionAux==null){mdlRegionAux=findIndexByKeyValue(modalRegions,"regionKey",parseInt(airports[z].region));
var g={regionKey:modalRegions[mdlRegionAux].regionKey,regionName:modalRegions[mdlRegionAux].regionName};depRegions.push(g);}}}}depRegions.sort(sort_by("regionKey",false));
}if(d==2){cityKey2=f.key;if(tabNum==1){$("#sector1_d").val(cityKey2);}if(tabNum==2){$("#destination").val(cityKey2);}}$(".close-icon").click(function(j){e.hide();
h.fadeIn();j.preventDefault();});$(".close-icon-1").click(function(j){j.preventDefault();if(tabNum==1){$("#sector1_o").val("");$("#sector1_d").val("");
}else{$("#origin").val("");$("#destination").val("");}cityKey1="";cityKey2="";});$(".close-icon-2").click(function(j){j.preventDefault();cityKey2="";if(tabNum==1){$("#sector1_d").val("");
}else{$("#destination").val("");}cityKey2="";});}function loadModalCities(e,k,g,l,f){var b='<span class="partner_roundtrip">'+modalLabels[0].modalPartnerOW+'</span><span class="partner_one-way">'+modalLabels[0].modalPartnerRT+"</span>";
var j="";var h=[];var d=20;$("#citiesModal").empty();var c="";c+='<div class="break_modal"><ul>';if(g==1){h=e;}if(g==2){if(tabNum==1){h=depAirports;}if(tabNum==2){h=depAirports_mlt;
}h.sort(sort_by("country",false));}for(x=0;x<h.length;x++){if(h[x].region==k){if(j!=h[x].country&&h[x].region!==1){j=h[x].country;d=d-3;if(d<0){c+='</ul></div><div class="break_modal">';
d=20;}c+='</ul><ul><li><span class="countryTitle">'+h[x].country+"</span></li>";}partnerClass=(h[x].partner===1)?"partner_roundtrip":"partner_one-way";
c+='<li><a href="#" class="cityModal '+partnerClass+'" title="'+h[x].label+'" rel="'+h[x].key+'">'+h[x].label+"</a></li>";d--;if(d<0){c+='</ul></div><div class="break_modal"><ul>';
d=20;if(h[x].region!==1){c+='<li><span class="countryBreak"></span></li>';d=d-3;}}}}c+="</ul></div>";$("#citiesModal").html(c);$("#modal-compra-partners").html(b);
$(".cityModal").click(function(){cityLabel1=$(this).attr("title");if(g==1){cityKey1=$(this).attr("rel");if(tabNum==1){$("#sector1_o").val(cityKey1);}if(tabNum==2){$("#origin").val(cityKey1);
}var m=findIndexByKeyValue(e,"key",cityKey1);depAirports=[];depAirports_mlt=[];depRegions=[];for(y=0;y<e[m]["depart"].length;y++){for(z=0;z<airports.length;
z++){if(e[m]["depart"][y]==airports[z].key){if(tabNum==1){depAirports.push(airports[z]);}if(tabNum==2){depAirports_mlt.push(airports[z]);}regionAux=findIndexByKeyValue(depRegions,"regionKey",parseInt(airports[z].region));
if(regionAux==null){mdlRegionAux=findIndexByKeyValue(modalRegions,"regionKey",parseInt(airports[z].region));var n={regionKey:modalRegions[mdlRegionAux].regionKey,regionName:modalRegions[mdlRegionAux].regionName};
depRegions.push(n);}}}}depRegions.sort(sort_by("regionKey",false));}if(g==2){cityKey2=$(this).attr("rel");if(tabNum==1){$("#sector1_d").val(cityKey2);}if(tabNum==2){$("#destination").val(cityKey2);
}}$("#modal-compra").removeClass("modal-compra");l.hide();f.html(cityLabel1+'<a href="#" id="closeIcon" class="close-icon close-icon-'+g+'">×</a>');f.fadeIn();
closeCompraModal();$(".close-icon-1").click(function(){$("#sector1_o").val("");$("#sector1_d").val("");cityKey1="";cityKey2="";});$(".close-icon-2").click(function(){$("#sector1_d").val("");
cityKey2="";});$(".close-icon").click(function(){f.hide();l.fadeIn();});});}function closeCompraModal(){$("#modal-compra-bg").removeClass("modal-compra-bg");
$("#citiesModal").empty();$("#modal-compra-partners").empty();var b=$(window).width();var c=$(window).height();modalCompra.animate({width:0,height:0,opacity:0,left:b/2,right:c/2,top:c/2});
modalOpen=false;}function openCompraModal(e,k,j,p,r,o,f){$("#modal-compra-bg").addClass("modal-compra-bg");$("#modal-compra-header").html("<h3>"+modalLabels[0].modalTitle+'<div id="modal-close"><a href="#" id="closeModalCompra" >×</a></div></h3>');
modalOpen=true;var l="";var m="";var c=$(window).width();var b=$(window).height();var d=c/2-360;var n=b/2-250;var q=720;var g=500;modalCompra.css({left:c/2,top:b/2});
modalCompra.animate({width:q,height:g,left:d,top:n,opacity:1},400,function(){loadModalCities(e,p,k,o,f);l="<h4>"+modalLabels[0].modalRegion+"</h4>";l+="<ul>";
for(x=0;x<r.length;x++){m=(p==r[x].regionKey)?"region_select":"";l+='<li><a href="#" id="mdlRegion_'+r[x].regionKey+'" title="'+r[x].regionTitle+'" rel="'+r[x].regionKey+'" class="regionModal '+m+'">'+r[x].regionName+"</a></li>";
}l+="</ul>";$("#modal-compra-region").html(l);$(".regionModal").click(function(){$("#mdlRegion_"+p).removeClass("region_select");$(this).addClass("region_select");
p=$(this).attr("rel");loadModalCities(e,p,k,o,f);});$("#closeModalCompra").click(function(){closeCompraModal();});});}citySelect1.click(function(){$(this).focusout();
openCompraModal(airports,1,0,1,modalRegions,cityInput1,depCitySelected);});citySelect2.click(function(){$(this).focusout();var b=$("#sector1_o").val();
if(b!=""){openCompraModal(depAirports,2,b,1,depRegions,cityInput2,retCitySelected);}else{alert(errorForm[4]);}});$("#modal-compra-bg").click(function(){closeCompraModal();
});$(document).keyup(function(b){if(b.keyCode==27){if(modalOpen){closeCompraModal();}if($("#sector1_d").val()!=""){retCitySelected.hide();ciudadDestino.val("");
cityInput2.fadeIn();ciudadSalida.focus();}if($("#sector1_o").val()!=""){depCitySelected.hide();cityInput1.fadeIn();ciudadSalida.val("");ciudadSalida.focus();
flagCalendar=0;}}});ciudadSalida.autocomplete({position:{my:"left top",at:"left-20 top+30",collision:"flip"},source:function(c,b){var d=new RegExp($.ui.autocomplete.escapeRegex(c.term),"i");
b($.grep(airports,function(e){e=e.label||e.value||e;return d.test(e)||d.test(normalize(e));}));},select:function(b,c){iChooChooChooseYou(1,c.item,cityInput1,depCitySelected,ciudadSalida);
ciudadDestino.focus();},appendTo:"#cityInput1"}).data("ui-autocomplete")._renderItem=function(c,d){var b=(d.partner==1)?"partner_roundtrip":"partner_one-way";
return $("<li class='autocomplete-option'></li>").data("item.autocomplete",d).append("<a class='"+b+"' href='#' onclick='return false'>"+d.label+"</a>").appendTo(c);
};ciudadDestino.autocomplete({position:{my:"left top",at:"left-20 top+30",collision:"flip"},source:function(d,b){if(cityKey1!=""){var c=[];var e=findIndexByKeyValue(airports,"key",cityKey1);
for(y=0;y<airports[e]["depart"].length;y++){for(z=0;z<airports.length;z++){if(airports[e]["depart"][y]==airports[z].key){var g={key:airports[z].key,label:airports[z].label,country:airports[z].country,partner:airports[z].partner};
c.push(g);}}}var f=new RegExp($.ui.autocomplete.escapeRegex(d.term),"i");b($.grep(c,function(h){h=h.label||h.value||h;return f.test(h)||f.test(normalize(h));
}));}else{}},select:function(b,c){iChooChooChooseYou(2,c.item,cityInput2,retCitySelected,ciudadDestino);if(flagCalendar==0){$("#fechaSalida").focus();}},delay:0,minLength:0,appendTo:cityInput2}).focus(function(){window.setTimeout(function(){if(ciudadDestino.val().length==0){ciudadDestino.autocomplete("search","");
}});}).click(function(){ciudadDestino.val("");window.setTimeout(function(){if(ciudadDestino.val().length==0){ciudadDestino.autocomplete("search","");}});
}).data("ui-autocomplete")._renderItem=function(c,d){var b=(d.partner==1)?"partner_roundtrip":"partner_one-way";return $("<li class='autocomplete-option'></li>").data("item.autocomplete",d).append("<a class='"+b+"' href='#' onclick='return false'>"+d.label+"</a>").appendTo(c);
};var months=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");$("#fechaSalidaButton").click(function(){$("#fechaSalida").focus();
});$("#fechaSalida").datepicker({numberOfMonths:2,dateFormat:"D, M dd, yy",minDate:0,maxDate:"+11m",minLength:0,delay:0,showButtonPanel:true,onSelect:function(c){dateA=$(this).datepicker("getDate");
var b=""+dateA.getDate();b=(b.length<2)?"0"+b:b;$("#depDay").val(b);var d=""+(dateA.getMonth()+1);d=(d.length<2)?"0"+d:d;$("#depMonth").val(months[dateA.getMonth()]);
if($("#depDesp")){$("#depDesp").val(dateA.getFullYear()+"-"+d+"-"+b);}dateAm=new Date(dateA.getTime());dateAm.setDate(dateAm.getDate());if(typeOWActive==0){$("#fechaRegreso").datepicker("option","minDate",dateAm);
setTimeout(function(){$("#fechaRegreso").focus();},150);}$("#fechaSalidaDiv").hide();$("#fechaSalidaSelected").html($("#fechaSalida").val()+'<a href="#" id="calendarIcon1" class="close-icon close-icon-2">×</a>');
$("#fechaSalidaSelected").fadeIn();flagCalendar=1;$("#calendarIcon1").click(function(){$("#fechaSalidaSelected").hide();$("#fechaSalidaDiv").fadeIn();$("#depDay").val("");
$("#depMonth").val("");$("#fechaSalida").val("");$("#fechaSalida").focus();flagCalendar=0;});if($("#fechaRegreso").val()>=$("#fechaSalida").val()){$("#fechaRegresoSelected").hide();
$("#fechaRegresoDiv").fadeIn();$("#fechaRegreso").val("");}}});$("#fechaRegresoButton").click(function(){$("#fechaRegreso").focus();});$("#fechaRegreso").datepicker({numberOfMonths:2,dateFormat:"D, M dd, yy",minDate:0,maxDate:"+11m",showButtonPanel:true,onSelect:function(c){dateB=$(this).datepicker("getDate");
var b=""+dateB.getDate();b=(b.length<2)?"0"+b:b;$("#retDay").val(b);var d=""+(dateB.getMonth()+1);d=(d.length<2)?"0"+d:d;$("#retMonth").val(months[dateB.getMonth()]);
if($("#retDesp")){$("#retDesp").val(dateB.getFullYear()+"-"+d+"-"+b);}$("#fechaRegresoDiv").hide();$("#fechaRegresoSelected").html($(this).val()+'<a href="#" id="calendarIcon2" class="close-icon close-icon-2">×</a>');
$("#fechaRegresoSelected").fadeIn();$("#calendarIcon2").click(function(){$("#fechaRegresoSelected").hide();$("#fechaRegresoDiv").fadeIn();$("#retDay").val("");
$("#retMonth").val("");$(this).val("");$(this).focus();});}});$(".modalajax").click(function(c){c.preventDefault();var b=$(c.target).attr("href");var d=$(c.target).attr("title");
if(b.indexOf("#")!=0){$.get(b,function(e){$("#modal-close").html('<a href="#" class="close">&times;</a>');$("#modal-title").html(d);$("#modal-body-ajax").load(b+" .ammodal");
$("#modal-from-dom").animate({top:"50%",opacity:1},400,function(){$(this).addClass("active");$(this).attr("style","");$("body").append('<div class="modal-backdrop"></div>');
});});}});var numCupons=addCupons();var inputsCheck=false;$("#ft-adult,#ft-child,#ft-baby").change(function(){numCupons=addCupons();});$("#add_coupon,#ft-code").click(function(){$("#coupons_bg").fadeIn("slow");
$("#ft-couponAux").focus();$("#ft-couponAux").removeClass("couponFocus");$("#ft-couponAux").removeClass("couponError");for(i=1;i<=numCupons;i++){$("#couponNumber"+i).removeClass("couponFocus");
$("#couponNumber"+i).removeClass("couponError");}inputsCheck=true;if($("#ft-couponAux").val()==""){inputsCheck=false;}for(i=1;i<=numCupons;i++){if($("#couponNumber"+i).val()==""){inputsCheck=false;
}}if(inputsCheck==true){$("#active_coupons").removeClass("button_inactive_coupon");$("#active_coupons").addClass("button_active_coupon");}else{$("#active_coupons").removeClass("button_active_coupon");
$("#active_coupons").addClass("button_inactive_coupon");}});$("#icon_close").click(function(){$("#modal-compra-bg").removeClass("modal-compra-bg");$("#coupons_bg").fadeOut();
$("#ft-couponAux").val("");$("#ft-code").val("");for(i=1;i<=numCupons;i++){$("#couponNumber"+i).val("");}inputsCheck=false;});$("#active_coupons").click(function(){var c=1;
inputsCheck==true;if($("#ft-couponAux").val()==""){$("#ft-couponAux").removeClass("couponFocus");$("#ft-couponAux").addClass("couponError");inputsCheck=false;
}for(c=1;c<=numCupons;c++){if($("#couponNumber"+c).val()==""){$("#couponNumber"+c).removeClass("couponFocus");$("#couponNumber"+c).addClass("couponError");
inputsCheck=false;}}if(inputsCheck==true){$("#coupons_bg").fadeOut();var b=$("#ft-couponAux").val();$("#ft-code").val(b);$("#active_coupons").removeClass("button_inactive_coupon");
$("#active_coupons").addClass("button_active_coupon");}else{$("#active_coupons").removeClass("button_active_coupon");$("#active_coupons").addClass("button_inactive_coupon");
}});$("#typeOW").click(function(){$("#fechaRegresoSelected").hide();$("#fechaRegresoDiv").fadeIn();$("#retDay").val("");$("#retMonth").val("");$("#fechaRegresoDiv").addClass("select_date_disabled");
$("#fechaRegreso").css("color","#777");$("#fechaRegreso").val(" ----------------------------------------------");$("#fechaRegreso").attr("disabled","disabled");
typeOWActive=1;});$("#typeRT").click(function(){$("#fechaRegresoDiv").removeClass("select_date_disabled");$("#fechaRegreso").css("color","#003263");$("#fechaRegreso").val("");
$("#fechaRegreso").removeAttr("disabled");$("#fechaRegreso").datepicker("option","minDate",dateAm);typeOWActive=0;if(!Modernizr.input.placeholder){$("input[placeholder]").placeholder();
}});addDateFlightView();$(document).on("click",".close, .modal-backdrop",function(b){b.preventDefault();$(".modal-backdrop").animate({opactity:0},400,function(){$(this).remove();
});$("#modal-from-dom").animate({opacity:0},400,function(){$(this).removeClass("active");$(this).attr("style","");});});$(".cuadroAviso").each(function(){$(this).attr("readonly","true");
});